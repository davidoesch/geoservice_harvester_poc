<!DOCTYPE html>
<html>

<head>
    <title>GeoHarvester Entdecken Sie die Welt der Geodaten - einfach und zugänglich mit GeoServiceHarvester.</title>
    <meta charset="utf-8" />
    <meta name="google-site-verification" content="hDQtbxFwRrQcdcq96Mb9jZW6YI_NHX_FhjBK1bXksqg" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Die Metadaten von Geodiensten wie WMS, WFS und WMTS sind ein ungenutzter Schatz, der eine Schlüsselrolle bei der Verbesserung der Auffindbarkeit von Geodaten spielen kann. Trotz der Existenz verschiedener Geodatenkataloge wie geocat.ch und opendata.swiss, bleiben viele Datensätze unauffindbar. Das liegt daran, dass die Daten und Metadaten getrennt behandelt werden und die manuell eingegebenen Metadatenkataloge nicht alle in den Diensten verfügbaren Daten enthalten. Durch die Analyse der Metadaten der einzelnen Datensätze des Bundes und der Kantone in geoservices können wir die Suchmaschinenoptimierung verbessern und die Daten besser auffindbar machen. Die gute Nachricht ist, dass das Harvesting von Geodiensten keine teure Raketenwissenschaft ist und mithilfe von OGC-Standards und Python-Bibliotheken wie owslib automatisch durchgeführt werden kann.">
    <meta name="keywords" content="Schweiz, WMS, WFS, WMTS, Behörden, Datensammlung, Geodaten, Geodateninfrastruktur, Geoharvester, Metadaten, Suchmaschine, Kartendienste, offene Daten, Datenaustausch,WMS, WFS, WMTS, Metadaten, Geodienste, Auffindbarkeit, SwissGeodata, Geodatenkataloge, Auffindbarkeit, geocat. ch, opendata.swiss, nationaler Metadatenkatalog, Schweiz, Datensätze, SEO, NLP, AI, OGC Standards, GetCapabilities, proof-of-concept, Geoservice Harvester, python library owslib, monitoring">
    <meta name="geo.placename" content="Schweiz, Aargau, Appenzell, Basel, Bern, Freiburg, Genf, Glarus, Graubünden, Jura, Luzern, Neuenburg, Nidwalden, Obwalden, St. Gallen, Schaffhausen, Schwyz, Solothurn, Thurgau, Tessin, Uri, Wallis, Waadt, Zug, Zürich" /><meta name="geo.region" content="CH" />
    <meta name="geo.position" content="46.8182;8.2275" />
    <meta name="ICBM" content="46.8182, 8.2275" />
    <meta name="language" content="de"/>
    <meta name="author" content="David Oesch Pasquale diDonato"/>
    <meta name="robots" content="index,follow"/>
    <meta name="revisit-after" content="7 days"/>
    
    <!-- Include jQuery, DataTables CSS, and DataTables JS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        table.dataTable {
            width: 100% !important;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
	<script>

function downloadQGISProjectWMS(data,name,owner,title,bbox) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', "https://raw.githubusercontent.com/davidoesch/geoservice_harvester_poc/main/qgis_wms_template.qlr");
    xhr.responseType = 'text';
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
			var bboxArray = bbox.split(" ");
			var xmin = bboxArray[0];
			var ymin = bboxArray[1];
			var xmax = bboxArray[2];
			var ymax = bboxArray[3];
			
            var projectXml = xhr.responseText;
            projectXml = projectXml.replace("{{SERVICELINK}}", data);
            projectXml = projectXml.replace("{{NAME}}", name);
			projectXml = projectXml.replace("{{TITLE}}", title);
			projectXml = projectXml.replace("{{OWNER}}", owner);
			projectXml = projectXml.replace("{{XMAX}}", xmax);
			projectXml = projectXml.replace("{{YMAX}}", ymax);
			projectXml = projectXml.replace("{{YMIN}}", ymin);
			projectXml = projectXml.replace("{{XMIN}}", xmin);
            var blob = new Blob([projectXml], {type: "application/xml"});
            var url = URL.createObjectURL(blob);
            var a = document.createElement("a");
            a.href = url;
            a.download = name + "_" + owner + ".qlr";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

        }
    };
    xhr.send();
}

function downloadQGISProjectWMTS(data,name,owner,title,bbox) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', "https://raw.githubusercontent.com/davidoesch/geoservice_harvester_poc/main/qgis_wmts_template.qlr");
    xhr.responseType = 'text';
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
			var bboxArray = bbox.split(" ");
			var xmin = bboxArray[0];
			var ymin = bboxArray[1];
			var xmax = bboxArray[2];
			var ymax = bboxArray[3];
			
            var projectXml = xhr.responseText;
            projectXml = projectXml.replace("{{SERVICELINK}}", data);
            projectXml = projectXml.replace("{{NAME}}", name);
			projectXml = projectXml.replace("{{NAME}}", name);
			projectXml = projectXml.replace("{{TITLE}}", title);
			projectXml = projectXml.replace("{{OWNER}}", owner);
			projectXml = projectXml.replace("{{XMAX}}", xmax);
			projectXml = projectXml.replace("{{YMAX}}", ymax);
			projectXml = projectXml.replace("{{YMIN}}", ymin);
			projectXml = projectXml.replace("{{XMIN}}", xmin);
            var blob = new Blob([projectXml], {type: "application/xml"});
            var url = URL.createObjectURL(blob);
            var a = document.createElement("a");
            a.href = url;
            a.download = name + "_" + owner + ".qlr";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

        }
    };
    xhr.send();
}

function downloadQGISProjectWFS(data,name,owner,title,bbox) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', "https://raw.githubusercontent.com/davidoesch/geoservice_harvester_poc/main/qgis_wfs_template.qlr");
    xhr.responseType = 'text';
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
			var bboxArray = bbox.split(" ");
			var xmin = bboxArray[0];
			var ymin = bboxArray[1];
			var xmax = bboxArray[2];
			var ymax = bboxArray[3];
			
            var projectXml = xhr.responseText;
            projectXml = projectXml.replace("{{SERVICELINK}}", data);
            projectXml = projectXml.replace("{{NAME}}", name);
			projectXml = projectXml.replace("{{TITLE}}", title);
			projectXml = projectXml.replace("{{OWNER}}", owner);
			projectXml = projectXml.replace("{{XMAX}}", xmax);
			projectXml = projectXml.replace("{{YMAX}}", ymax);
			projectXml = projectXml.replace("{{YMIN}}", ymin);
			projectXml = projectXml.replace("{{XMIN}}", xmin);
            var blob = new Blob([projectXml], {type: "application/xml"});
            var url = URL.createObjectURL(blob);
            var a = document.createElement("a");
            a.href = url;
            a.download = name + "_" + owner + ".qlr";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

        }
    };
    xhr.send();
}

function copyLink(link, button) {
    var tempInput = document.createElement("input");
    tempInput.value = link;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand("copy");
    document.body.removeChild(tempInput);
    button.innerHTML = "Kopiert!";
	    $(button).addClass('btn-danger');
    setTimeout(function() {
        $(button).removeClass('btn-danger');
    }, 1000);
}

// Usage:
// Assuming "data" and "row.NAME" are available:
// var downloadButton = "<button onclick='downloadQGISProject(\"" + data + "\", \"" + row.NAME + "\")'>QGIS DOWNLOAD</button> <button onclick='copyLink(\"" + data + "\", this)'>COPY WMS</button>";
// Then you can add the "downloadButton" HTML string to a table cell or any other element you want.





    </script>
    <script>
        var cookies = document.cookie.split('; ');
        for (var i = 0; i < cookies.length; i++) {
            var parts = cookies[i].split('=');
            if (parts[0] === 'PHPSESSID') {
                var sessionId = parts[1];
                // Do something with sessionId
                document.cookie = "PHPSESSID=" + sessionId + "; SameSite=None; Secure";
                break;
            }
        }
        $(document).ready(function() {
            // Load CSV file with PapaParse and DataTables
            Papa.parse("https://raw.githubusercontent.com/davidoesch/geoservice_harvester_poc/main/data/geoservices_CH.csv", {
                download: true,
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true,
                complete: function(results) {
                    var table = $('#table').DataTable({
                        "data": results.data,
                        "columns": [{
                            "data": "OWNER",
                            "title": "Behörde"
                        }, {
                            "data": "TITLE",
                            "title": "Title"
                        }, {
                            "data": "MAPGEO",
                            "title": "Karte",
                            "render": function(data, type, row) {
                                if (row.SERVICETYPE === "WFS") {
                                    return "WFS";
                                } else if (type === "display") {
									return "<a href='#' onclick='window.open(\"" + data + "\")'>Karte</a>";
								}
                                return data;
                            }
                        }, {
                            "data": "SERVICELINK",
                            "title": "Dienst",
							"render": function(data, type, row) {
									if (row.SERVICETYPE === "WMS") {
										return "<button onclick='downloadQGISProjectWMS(\"" + data + "\", \"" + row.NAME + "\", \"" + row.OWNER + "\",\"" + row.TITLE + "\", \"" + row.BBOX + "\")'>Open in QGIS</button> <button onclick='copyLink(\"" + data + "\", this)'>COPY WMS</button>";
									}
									if (row.SERVICETYPE === "WMTS") {
										return "<button onclick='downloadQGISProjectWMTS(\"" + data + "\", \"" + row.NAME + "\", \"" + row.OWNER + "\",\"" + row.TITLE + "\", \"" + row.BBOX + "\")'>Open in QGIS</button> <button onclick='copyLink(\"" + data + "\", this)'>COPY WMTS</button>";
									}
									if (row.SERVICETYPE === "WFS") {
										return "<button onclick='downloadQGISProjectWFS(\"" + data + "\", \"" + row.NAME + "\", \"" + row.OWNER + "\",\"" + row.TITLE + "\", \"" + row.BBOX + "\")'>Open in QGIS</button> <button onclick='copyLink(\"" + data + "\", this)'>COPY WFS</button>";
									}
							   
								return data;
							}

                        },{
                            "data": "ABSTRACT",
                            "title": "Beschreibung"
                        }, {
                            "data": "KEYWORDS",
                            "title": "Keywords"
                        }, {
                            "data": "CONTACT",
                            "title": "Kontakt"
                        }, {
                            "data": "LEGEND",
							"title": "Legende",
							"render": function(data, type, row) {
								if (type === "display" && data !== null && data !== "") {
									return "<a href='#' onclick='window.open(\"" + data + "\")'>Legende</a>";
								}
								return data;
							}

                        }, {
                            "data": "METADATA",
                            "title": "Metadata",
							"render": function(data, type, row) {
								if (type === "display" && data !== null && data !== "") {
									return "<a href='#' onclick='window.open(\"" + data + "\")'>Metadata</a>";
								}
								return data;
							}
                        }, ],
                        "order": [
                            [0, "asc"]
                        ], // Default sort by 'OWNER' ascending
                        "paging": true, // Enable pagination
                        "lengthMenu": [10, 25, 50, 100], //
                        "columnDefs": [{
                            "targets": 1,
                            "width": "60%"
                        }, {
                            "targets": 3,
                            "width": "40%"
                        }, {
                            "targets": [0, 2, 4, 5, 6, 7],
                            "width": "10%"
                        }],
                        "responsive": true // added option for responsive table
                    });
                    $('#toggle-columns').on('click', function() {
                        table.columns().visible(!table.column(0).visible());
                    });
$("button").click(function(){
  $(this).toggleClass("btn-danger");
});

                }
            });
        });
    </script>
</head>

<body>
    <div style="text-align: center;">
  	<h1 style="font-family: 'Montserrat', sans-serif; font-size: 48px; font-weight: 700; color: #333;">GeoHarvester (ProofOfConcept)</h1>
    </div>

    <div style="font-family: 'Montserrat', sans-serif; font-size: 24px; font-weight: 700; text-align: center; color: #333;">Entdecken Sie die Schweizer  Geodaten - einfach und zugänglich mit GeoHarvester.</div>

    <div style="text-align: center;">	
    <p>| Alle DATA-Attribute: <a href="https://davidoesch.github.io/geoservice_harvester_poc/data/geodata_CH.csv">download</a> || Alle SERVICES Attribute: <a href="https://davidoesch.github.io/geoservice_harvester_poc/data/geoservices_CH.csv">download</a> || Source Code: <a href="https://github.com/davidoesch/geoservice_harvester_poc">GitHub</a> || Qualitätskontrolle: <a href="https://davidoesch.github.io/geoservice_harvester_poc/#anchor-QualityControl"> ansehen</a> || Letzte Aktualisieurng: <img src="https://img.shields.io/github/last-commit/davidoesch/geoservice_harvester_poc" alt="LastUpdate"> | </p>
    </div>
    <br>
    <p>GeoHarvester ist ein Portal, das die offiziellen Geodaten der Dienste der Schweizer Behörden zusammenführt. Wir bieten eine einfache Möglichkeit, auf öffentliche Geodaten zuzugreifen. Unser Ziel ist es, den Zugang und die Nutzung von Geodaten der Schweizer Behörden für jedermann/frau einfach zu machen. Bei uns finden Sie die Daten als Dienst, Metadaten und Informationen zu den Datensätzen wie Titel, Eigentümer, Zusammenfassung, Service-Link, Legenden und sogar eine KartenAnsicht. Wir bieten auch qualitative Statistiken, um Ihnen bei der Auswahl der besten Daten für Ihre Bedürfnisse zu helfen. Unsere Plattform ist benutzerfreundlich und unser Ziel ist es, Ihnen den direktesten Zugang zu Geodaten zu bieten.</p>
    <br>
    <p> Bitte haben Sie etwas Geduld - das Laden von über 15'000 Datensätzen braucht seine Zeit </p>
    </p>
    <table id="table" class="display">
        <thead>
            <tr>
                <th>OWNER</th>
                <th>TITLE</th>
                <th>ABSTRACT</th>
				<th>SERVICELINK</th>
                <th>KEYWORDS</th>
                <th>SERVICELINK</th>
                <th>CONTACT</th>
                <th>LEGEND</th>
                <th>METADATA</th>
            </tr>
        </thead>
    </table>
    <p>
        <a id="anchor-QualityControl"><b>Quality Control</b></a>
        <br>
        <iframe title="Durchschnitt Vollständigkeit :  SCHLÜSSELWÖRTER, ABSTRACT, KONTAKT und METADATEN" aria-label="Balken (gestapelt)" id="datawrapper-chart-DuVHo" src="https://datawrapper.dwcdn.net/DuVHo/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="721" data-external="1"></iframe>
        <script type="text/javascript">
            ! function() {
                "use strict";
                window.addEventListener("message", (function(e) {
                    if (void 0 !== e.data["datawrapper-height"]) {
                        var t = document.querySelectorAll("iframe");
                        for (var a in e.data["datawrapper-height"])
                            for (var r = 0; r < t.length; r++) {
                                if (t[r].contentWindow === e.source) t[r].style.height = e.data["datawrapper-height"][a] + "px"
                            }
                    }
                }))
            }();
        </script>
        <br>
        <iframe title="Vollständigkeit des KEYWORD ABSTRACT CONTACT AND METADATA-Datensatzes in Dienstleistungen " aria-label="Balken (separat)" id="datawrapper-chart-XoJn7" src="https://datawrapper.dwcdn.net/XoJn7/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="711" data-external="1"></iframe>
        <script type="text/javascript">
            ! function() {
                "use strict";
                window.addEventListener("message", (function(e) {
                    if (void 0 !== e.data["datawrapper-height"]) {
                        var t = document.querySelectorAll("iframe");
                        for (var a in e.data["datawrapper-height"])
                            for (var r = 0; r < t.length; r++) {
                                if (t[r].contentWindow === e.source) t[r].style.height = e.data["datawrapper-height"][a] + "px"
                            }
                    }
                }))
            }();
        </script>
</body>

</html>
